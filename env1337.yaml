id: env-file-disclosure-all

info:
  name: Comprehensive .env File Disclosure
  author: Magsec1337
  severity: high
  description: Detects exposed .env files that may contain sensitive environment variables like API keys, DB credentials, and secrets.
  tags: exposure,env,config,leak

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/env"
      - "{{BaseURL}}/.env.bak"
      - "{{BaseURL}}/.env.backup"
      - "{{BaseURL}}/.env-old"
      - "{{BaseURL}}/.env.txt"
      - "{{BaseURL}}/.env~"
      - "{{BaseURL}}/.env.prod"
      - "{{BaseURL}}/.env.production"
      - "{{BaseURL}}/.env.local"
      - "{{BaseURL}}/api/.env"
      - "{{BaseURL}}/laravel/.env"
      - "{{BaseURL}}/backend/.env"
      - "{{BaseURL}}/core/.env"
      - "{{BaseURL}}/config/.env"
      - "{{BaseURL}}/admin/.env"
      - "{{BaseURL}}/server/.env"
      - "{{BaseURL}}/web/.env"
      - "{{BaseURL}}/v1/.env"
      - "{{BaseURL}}/app/.env"
      - "{{BaseURL}}/application/.env"
      - "{{BaseURL}}/public/.env"
      - "{{BaseURL}}/src/.env"
      - "{{BaseURL}}/old/.env"
      - "{{BaseURL}}/private/.env"
      - "{{BaseURL}}/test/.env"
      - "{{BaseURL}}/tmp/.env"
      - "{{BaseURL}}/temp/.env"
      - "{{BaseURL}}/new/.env"
      - "{{BaseURL}}/files/.env"
      - "{{BaseURL}}/logs/.env"
      - "{{BaseURL}}/site/.env"
      - "{{BaseURL}}/data/.env"
      - "{{BaseURL}}/dev/.env"
      - "{{BaseURL}}/database/.env"
      - "{{BaseURL}}/beta/.env"
      - "{{BaseURL}}/db/.env"
      - "{{BaseURL}}/staging/.env"
      - "{{BaseURL}}/website/.env"
      - "{{BaseURL}}/htdocs/.env"
      - "{{BaseURL}}/html/.env"
      - "{{BaseURL}}/secure/.env"
      - "{{BaseURL}}/dump/.env"
      - "{{BaseURL}}/backup/.env"
      - "{{BaseURL}}/bin/.env"
      - "{{BaseURL}}/acme_challenges/.env"
      - "{{BaseURL}}/acme-challenge/.env"
      - "{{BaseURL}}/acme/.env"
      - "{{BaseURL}}/actions-server/.env"
      - "{{BaseURL}}/admin-app/.env"
      - "{{BaseURL}}/adminer/.env"
      - "{{BaseURL}}/administrator/.env"
      - "{{BaseURL}}/agora/.env"
      - "{{BaseURL}}/alpha/.env"
      - "{{BaseURL}}/anaconda/.env"
      - "{{BaseURL}}/e2e/.env"
      - "{{BaseURL}}/ci/.env"
      - "{{BaseURL}}/cli/.env"
      - "{{BaseURL}}/configurations/.env"
      - "{{BaseURL}}/container/.env"
      - "{{BaseURL}}/deploy/.env"
      - "{{BaseURL}}/devops/.env"
      - "{{BaseURL}}/docker/.env"
      - "{{BaseURL}}/docs/.env"
      - "{{BaseURL}}/editor/.env"
      - "{{BaseURL}}/example/.env"
      - "{{BaseURL}}/framework/.env"
      - "{{BaseURL}}/graphql/.env"
      - "{{BaseURL}}/http/.env"
      - "{{BaseURL}}/infra/.env"
      - "{{BaseURL}}/integration/.env"
      - "{{BaseURL}}/k8s/.env"
      - "{{BaseURL}}/lib/.env"
      - "{{BaseURL}}/mobile/.env"
      - "{{BaseURL}}/modules/.env"
      - "{{BaseURL}}/monitor/.env"
      - "{{BaseURL}}/next/.env"
      - "{{BaseURL}}/node/.env"
      - "{{BaseURL}}/nodejs/.env"
      - "{{BaseURL}}/npm/.env"
      - "{{BaseURL}}/nuxt/.env"
      - "{{BaseURL}}/package/.env"
      - "{{BaseURL}}/packages/.env"
      - "{{BaseURL}}/panel/.env"
      - "{{BaseURL}}/portal/.env"
      - "{{BaseURL}}/project/.env"
      - "{{BaseURL}}/projects/.env"
      - "{{BaseURL}}/python/.env"
      - "{{BaseURL}}/react/.env"
      - "{{BaseURL}}/releases/.env"
      - "{{BaseURL}}/scripts/.env"
      - "{{BaseURL}}/services/.env"
      - "{{BaseURL}}/source/.env"
      - "{{BaseURL}}/static/.env"
      - "{{BaseURL}}/storage/.env"
      - "{{BaseURL}}/studio/.env"
      - "{{BaseURL}}/swagger/.env"
      - "{{BaseURL}}/tools/.env"
      - "{{BaseURL}}/ui/.env"
      - "{{BaseURL}}/upload/.env"
      - "{{BaseURL}}/uploads/.env"
      - "{{BaseURL}}/vendor/.env"
      - "{{BaseURL}}/vue/.env"
      - "{{BaseURL}}/webpack/.env"
      - "{{BaseURL}}/workspace/.env"
      - "{{BaseURL}}/x/.env"
      - "{{BaseURL}}/yaml/.env"
      - "{{BaseURL}}/z/.env"

    matchers:
      - type: word
        part: body
        condition: or
        words:
          - "APP_KEY="
          - "DB_PASSWORD="
          - "MAIL_PASSWORD="
          - "SECRET_KEY="
          - "AWS_SECRET_ACCESS_KEY="
